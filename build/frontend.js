(()=>{"use strict";!function(e){const t=e("#send-invitations"),n=e("#send-invitations-list");let c;const o=e("#new-connection-search");o.length&&(o.autocomplete({minLength:2,source:ajaxurl+"?action=openlab_connection_group_search",select:function(e,t){if(document.getElementById("connection-invitation-group-"+t.item.groupId))return!1;const c=wp.template("openlab-connection-invitation")(t.item);return n.append(c),s(),o.val(""),!1}}).autocomplete("instance")._renderItem=function(t,n){return e("<li>").append("<div><strong>"+n.groupName+"</strong><br>"+n.groupUrl+"</div>").appendTo(t)}),n.on("click",".remove-connection-invitation",(function(e){return e.target.closest(".group-item").remove(),s(),!1}));const s=()=>{n.children().length>0?t.show():t.hide()};document.querySelectorAll(".accordion").forEach((e=>{const t=e.querySelector(".accordion-toggle"),n=e.querySelector(".accordion-content");t.addEventListener("click",(()=>{const e="true"===t.getAttribute("aria-expanded")||!1;t.setAttribute("aria-expanded",!e),n.style.display=e?"none":"block"}))})),document.querySelectorAll(".disconnect-button").forEach((e=>{const t=e.getAttribute("aria-label"),n=e.innerHTML;e.addEventListener("mouseenter",(()=>{e.textContent=t})),e.addEventListener("mouseleave",(()=>{e.textContent=n}))})),e(".connection-tax-term-selector").select2({width:"80%"});const i=()=>{const t=document.querySelectorAll(".connection-settings"),n=document.getElementById("current-group-site-status")?.value;t.forEach((t=>{const c=t.querySelector(".connection-setting-none");c&&(n&&"public"!==n?(t.classList.add("disabled"),t.querySelector(".connection-tax-term-selector").disabled=!0,t.querySelector(".connection-setting-exclude-comments").disabled=!0,e(t).find(".connection-setting").addClass("is-disabled"),c.checked=!0,c.disabled=!0):c.checked?(t.classList.add("disabled"),t.querySelector(".connection-tax-term-selector").disabled=!0,t.querySelector(".connection-setting-exclude-comments").disabled=!0):(t.classList.remove("disabled"),t.querySelector(".connection-tax-term-selector").disabled=!1,t.querySelector(".connection-setting-exclude-comments").disabled=!1))}))};i(),e(".connection-setting-none").on("change",(t=>{const n=e(t.target).closest(".connection-settings").find(".connection-tax-term-selector");n&&(t.target.checked?n.val([]).trigger("change"):n.val(["_all"]).trigger("change"),i())}));const l=t=>{const n=document.getElementById("connection-settings-"+t),c=e("#connection-"+t+"-categories").val(),o=document.getElementById("connection-"+t+"-exclude-comments").checked,s=e("#connection-settings-"+t+"-nonce").val(),i={connectionId:t,excludeComments:o,selectedPostCategories:c,groupId:n.closest(".connections-settings").dataset.groupId,nonce:s};e.post({url:ajaxurl+"?action=openlab_connections_save_connection_settings",data:i})};document.querySelectorAll('.connection-settings input[type="checkbox"]').forEach((e=>{e.addEventListener("change",(()=>{i(),clearTimeout(c),c=setTimeout((()=>{l(e.closest(".connection-settings").dataset.connectionId)}),500)}))})),e(".connection-settings select").on("select2:selecting",(t=>{const n=e(t.target).val(),c=t.params.args.data.id;let o;"_all"===c?o=["_all"]:(o=n.filter((e=>"_all"!==e)),o.push(c)),e(t.target).val(o).trigger("change")})),e(".connection-settings select").on("change.select2",(e=>{i(),clearTimeout(c),c=setTimeout((()=>{l(e.target.closest(".connection-settings").dataset.connectionId)}),500)})),e(".connection-settings select").on("select2:close",(t=>{0===e(t.target).val().length&&e(t.target).val(["_all"]).trigger("change")})),e(".connection-privacy-notices").each(((e,t)=>{console.log(t),t.querySelectorAll("p").length&&t.classList.remove("is-hidden")}))}(jQuery)})();