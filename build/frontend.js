(()=>{"use strict";!function(e){const t=e("#send-invitations"),n=e("#send-invitations-list");let o;const c=e("#new-connection-search");c.length&&(c.autocomplete({minLength:2,source:ajaxurl+"?action=openlab_connection_group_search",select:function(e,t){if(document.getElementById("connection-invitation-group-"+t.item.groupId))return!1;const o=wp.template("openlab-connection-invitation")(t.item);return n.append(o),i(),!1}}).autocomplete("instance")._renderItem=function(t,n){return e("<li>").append("<div><strong>"+n.groupName+"</strong><br>"+n.groupUrl+"</div>").appendTo(t)}),n.on("click",".remove-connection-invitation",(function(e){return e.target.closest(".group-item").remove(),i(),!1}));const i=()=>{n.children().length>0?t.show():t.hide()};document.querySelectorAll(".accordion").forEach((e=>{const t=e.querySelector(".accordion-toggle"),n=e.querySelector(".accordion-content");t.addEventListener("click",(()=>{const e="true"===t.getAttribute("aria-expanded")||!1;t.setAttribute("aria-expanded",!e),n.style.display=e?"none":"block"}))})),document.querySelectorAll(".disconnect-button").forEach((e=>{const t=e.getAttribute("aria-label"),n=e.innerHTML;e.addEventListener("mouseenter",(()=>{e.textContent=t})),e.addEventListener("mouseleave",(()=>{e.textContent=n}))})),e(".connection-tax-term-selector").select2({width:"80%"});const s=()=>{const t=document.querySelectorAll(".connection-settings"),n=document.getElementById("current-group-site-status")?.value;t.forEach((t=>{const o=t.querySelector(".connection-setting-none");o&&(n&&"public"!==n?(t.classList.add("disabled"),t.querySelector(".connection-tax-term-selector").disabled=!0,t.querySelector(".connection-setting-exclude-comments").disabled=!0,e(t).find(".connection-setting").addClass("is-disabled"),o.checked=!0,o.disabled=!0,t.querySelector(".connection-private-group-notice").classList.remove("is-hidden")):o.checked?(t.classList.add("disabled"),t.querySelector(".connection-tax-term-selector").disabled=!0,t.querySelector(".connection-setting-exclude-comments").disabled=!0):(t.classList.remove("disabled"),t.querySelector(".connection-tax-term-selector").disabled=!1,t.querySelector(".connection-setting-exclude-comments").disabled=!1))}))};s(),e(".connection-setting-none").on("change",(t=>{const n=e(t.target).closest(".connection-settings").find(".connection-tax-term-selector");n&&(t.target.checked?n.val([]).trigger("change"):n.val(["_all"]).trigger("change"),s())}));const r=t=>{const n=document.getElementById("connection-settings-"+t),o=e("#connection-"+t+"-categories").val(),c=document.getElementById("connection-"+t+"-exclude-comments").checked,i=e("#connection-settings-"+t+"-nonce").val(),s={connectionId:t,excludeComments:c,selectedPostCategories:o,groupId:n.closest(".connections-settings").dataset.groupId,nonce:i};e.post({url:ajaxurl+"?action=openlab_connections_save_connection_settings",data:s})};document.querySelectorAll('.connection-settings input[type="checkbox"]').forEach((e=>{e.addEventListener("change",(()=>{s(),clearTimeout(o),o=setTimeout((()=>{r(e.closest(".connection-settings").dataset.connectionId)}),500)}))})),e(".connection-settings select").on("select2:selecting",(t=>{const n=e(t.target).val(),o=t.params.args.data.id;let c;"_all"===o?c=["_all"]:(c=n.filter((e=>"_all"!==e)),c.push(o)),e(t.target).val(c).trigger("change")})),e(".connection-settings select").on("change.select2",(e=>{s(),clearTimeout(o),o=setTimeout((()=>{r(e.target.closest(".connection-settings").dataset.connectionId)}),500)})),e(".connection-settings select").on("select2:close",(t=>{0===e(t.target).val().length&&e(t.target).val(["_all"]).trigger("change")}))}(jQuery)})();