(()=>{"use strict";const e=window.wp.i18n;!function(t){const n=t("#send-invitations"),c=t("#send-invitations-list");let o;const s=t("#new-connection-search");s.length&&(s.autocomplete({minLength:2,source:ajaxurl+"?action=openlab_connection_group_search",select:function(e,t){if(document.getElementById("connection-invitation-group-"+t.item.groupId))return!1;const n=wp.template("openlab-connection-invitation")(t.item);return c.append(n),i(),s.val(""),!1}}).autocomplete("instance")._renderItem=function(e,n){return t("<li>").append("<div><strong>"+n.groupName+"</strong><br>"+n.groupUrl+"</div>").appendTo(e)}),c.on("click",".remove-connection-invitation",(function(e){return e.target.closest(".group-item").remove(),i(),!1}));const i=()=>{c.children().length>0?n.show():n.hide()};document.querySelectorAll(".accordion").forEach((e=>{const t=e.querySelector(".accordion-toggle"),n=e.querySelector(".accordion-content");t.addEventListener("click",(()=>{const e="true"===t.getAttribute("aria-expanded")||!1;t.setAttribute("aria-expanded",!e),n.style.display=e?"none":"block"}))})),document.querySelectorAll(".disconnect-button").forEach((e=>{const t=e.getAttribute("aria-label"),n=e.innerHTML;e.addEventListener("mouseenter",(()=>{e.textContent=t})),e.addEventListener("mouseleave",(()=>{e.textContent=n}))})),t(".connection-tax-term-selector").select2({width:"80%"});const a=()=>{const e=document.querySelectorAll(".connection-settings"),n=document.getElementById("current-group-site-status")?.value;e.forEach((e=>{const c=e.querySelector(".connection-setting-none");c&&(n&&"public"!==n?(e.classList.add("disabled"),e.querySelector(".connection-tax-term-selector").disabled=!0,e.querySelector(".connection-setting-exclude-comments").disabled=!0,t(e).find(".connection-setting").addClass("is-disabled"),c.checked=!0,c.disabled=!0):c.checked?(e.classList.add("disabled"),e.querySelector(".connection-tax-term-selector").disabled=!0,e.querySelector(".connection-setting-exclude-comments").disabled=!0):(e.classList.remove("disabled"),e.querySelector(".connection-tax-term-selector").disabled=!1,e.querySelector(".connection-setting-exclude-comments").disabled=!1))}))};a(),t(".connection-setting-none").on("change",(e=>{const n=t(e.target).closest(".connection-settings").find(".connection-tax-term-selector");n&&(e.target.checked?n.val([]).trigger("change"):n.val(["_all"]).trigger("change"),a())}));const l=e=>{const n=document.getElementById("connection-settings-"+e),c=t("#connection-"+e+"-categories").val(),o=document.getElementById("connection-"+e+"-exclude-comments").checked,s=t("#connection-settings-"+e+"-nonce").val(),i=n.closest(".connections-settings").dataset.groupId,a={connectionId:e,excludeComments:o,selectedPostCategories:c,groupId:i,nonce:s};t.post({url:ajaxurl+"?action=openlab_connections_save_connection_settings",data:a,success:t=>{t.success?r(e,"saved"):r(e,"error")}})},r=(t,n)=>{const c=document.getElementById("connection-settings-save-status-"+t);switch(["is-saving","is-saved"].forEach((e=>c.classList.remove(e))),n){case"saving":c.classList.add("is-saving"),c.innerHTML=(0,e.__)("Saving...","openlab-connections");break;case"saved":c.classList.add("is-saved"),c.innerHTML=(0,e.__)("Saved!","openlab-connections")}};document.querySelectorAll('.connection-settings input[type="checkbox"]').forEach((e=>{e.addEventListener("change",(()=>{const t=e.closest(".connection-settings").dataset.connectionId;r(t,"saving"),a(),clearTimeout(o),o=setTimeout((()=>{l(t)}),500)}))})),t(".connection-settings select").on("select2:selecting",(e=>{const n=t(e.target).val(),c=e.params.args.data.id;let o;"_all"===c?o=["_all"]:(o=n.filter((e=>"_all"!==e)),o.push(c)),t(e.target).val(o).trigger("change")})),t(".connection-settings select").on("change.select2",(e=>{const t=e.target.closest(".connection-settings").dataset.connectionId;r(t,"saving"),a(),clearTimeout(o),o=setTimeout((()=>{l(t)}),500)})),t(".connection-settings select").on("select2:close",(e=>{0===t(e.target).val().length&&t(e.target).val(["_all"]).trigger("change")})),t(".connection-privacy-notices").each(((e,t)=>{console.log(t),t.querySelectorAll("p").length&&t.classList.remove("is-hidden")}))}(jQuery)})();